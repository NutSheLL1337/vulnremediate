{# templates/patch_sqli.j2 #}
--- a/{{ file }}
+++ b/{{ file }}
@@
-{{ vulnerable_line }}
+// Autogenerated fix: use prepared statement to avoid SQL injection
+<?php
+$stmt = mysqli_prepare({{ conn_var }}, "{{ prepared_sql }}");
+if ($stmt) {
+    mysqli_stmt_bind_param($stmt, "{{ bind_types }}", {{ bind_vars }});
+    mysqli_stmt_execute($stmt);
+    $res = mysqli_stmt_get_result($stmt);
+} else {
+    // Fallback: original query if prepare failed
+    {{ vulnerable_line }}
+}
+?>
