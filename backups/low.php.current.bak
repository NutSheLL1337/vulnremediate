<?php
// ... (контекстно-залишити інші частини файлу як є — тут вставлено лише фрагмент щоб уникнути помилок)
// (нині в demo ми замінюємо 1 рядок SQL на prepared statement)
	// Autogenerated demo fix: use prepared statement to avoid SQL injection.
	// REVIEW: ensure $mysqli/$conn variable is correct for this file.
	$dbConn = isset($mysqli) ? $mysqli : (isset($conn) ? $conn : (isset($link) ? $link : null));
	if ($dbConn) {
// Autogenerated demo fix: use prepared statement to avoid SQL injection.
// REVIEW: ensure $mysqli/$conn variable is correct for this file.
$dbConn = isset($mysqli) ? $mysqli : (isset($conn) ? $conn : (isset($link) ? $link : null));
if ($dbConn) {
    $sql_tpl = "SELECT * FROM `users` WHERE user = ? AND password = ?";
    $stmt = @mysqli_prepare($dbConn, $sql_tpl);
    if ($stmt) {
        mysqli_stmt_bind_param($stmt, "ss", $user, $pass);
        mysqli_stmt_execute($stmt);
        $res = mysqli_stmt_get_result($stmt);
        // fetch rows as needed
    } else {
        $query  = "SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';";
    }
} else {
    $query  = "SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';";
}
	    $stmt = @mysqli_prepare($dbConn, $sql_tpl);
	    if ($stmt) {
	        mysqli_stmt_bind_param($stmt, "ss", $user, $pass);
	        mysqli_stmt_execute($stmt);
	        $res = mysqli_stmt_get_result($stmt);
	        // fetch rows as needed
	    } else {
	        // fallback to original query if prepare failed
	        $query  = "SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';";
	    }
	} else {
	    // no DB connection variable found — keep original behavior
	    $query  = "SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';";
	}
